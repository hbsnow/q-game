# デバッグレイアウト実装ルール

## 基本方針

レイアウト実装時は、必ずデバッグ用の視覚的ガイドラインを追加して、各エリアの境界を明確にする。

## 必須実装項目

### 0. エリア定義の基本原則

#### 空白エリア禁止ルール
**実際のコンテンツが存在しないエリアは定義してはいけない**

✅ **やるべきこと**:
- 実際にUI要素があるエリアのみを定義する
- コンテンツの実際の配置に合わせてエリア境界を設定する
- 空白部分はエリア定義しない（無視する）
- **画面全体をエリアで埋める必要はない**

❌ **やってはいけないこと**:
- 何もない空白部分にエリアを作る
- 空白を埋めるためにエリアを拡張する
- 画面全体を無理やりエリアで分割する
- **空白エリアを他のエリアで統合する**

#### 正しい理解の例
```typescript
// ❌ 悪い例：空白を埋めるためにフッターエリアを拡張
const footerRect = this.add.rectangle(width / 2, 585, width - 4, 246, 0x000000, 0)
  .setStrokeStyle(3, 0xFF00FF);
// → Y=460-640は空白なのにエリア定義している

// ✅ 良い例：実際のコンテンツがある部分のみ
// Y=460-640: 何もないのでエリア定義しない
// Y=660: バージョン表示があるのでエリア定義する
const versionRect = this.add.rectangle(width / 2, 660, width - 4, 40, 0x000000, 0)
  .setStrokeStyle(3, 0xFF00FF);
```

#### 重要な原則
- **空白部分 = エリア定義不要**
- **コンテンツ部分 = エリア定義必要**
- **空白を埋めるためのエリア拡張は禁止**

### 1. DebugHelperクラスの使用

#### 推奨実装方法
```typescript
import { DebugHelper } from '../utils/DebugHelper';

export class YourScene extends Phaser.Scene {
  private debugHelper!: DebugHelper;

  create() {
    // デバッグヘルパーを初期化
    this.debugHelper = new DebugHelper(this);
    
    // エリア境界線を追加
    this.debugHelper.addAreaBorder(x, y, width, height, color, 'エリア名');
  }
}
```

#### ショートカットキー
- **Dキー**: デバッグライン表示/非表示切り替え
- **Shift+Dキー**: デバッグ情報をコンソール出力

### 2. エリア境界の可視化

#### エリア別の色分け
- **タイトルエリア**: 赤色（0xFF0000）
- **ナビゲーション/メニューエリア**: 緑色（0x00FF00）
- **コンテンツエリア**: 青色（0x0000FF）
- **メインコンテンツ/アイテム表示エリア**: 黄色（0xFFFF00）
- **ボタン/アクションエリア**: 紫色（0xFF00FF）
- **フッターエリア**: 水色（0x00FFFF）

### 3. 実装テンプレート

#### 基本的な使用方法
```typescript
private addDebugLines() {
  const { width, height } = this.cameras.main;
  
  // タイトルエリア
  this.debugHelper.addAreaBorder(width / 2, 30, width - 4, 56, 0xFF0000, 'タイトルエリア');
  
  // メインコンテンツエリア
  this.debugHelper.addAreaBorder(width / 2, 200, width - 4, 300, 0xFFFF00, 'メインコンテンツ');
  
  // ボタンエリア
  this.debugHelper.addAreaBorder(width / 2, 650, width - 4, 80, 0xFF00FF, 'ボタンエリア');
}
```

## 適用場面

### 必須適用画面
- アイテム選択画面
- メイン画面
- ゲーム画面
- リザルト画面
- ガチャ画面

### 適用タイミング
- 新しい画面を実装する時
- レイアウトを変更する時
- 座標計算に問題がある時
- UI要素の重なりが発生した時

## デバッグライン削除

### 削除条件
**デバッグラインの削除は、ユーザーから明示的な指示があった場合のみ実行する**

### 削除してはいけない場合
- レイアウトが完璧に動作していても、指示がない限り削除しない
- 座標問題が解決していても、指示がない限り削除しない
- UI/UXが完成していても、指示がない限り削除しない

### 削除の判断基準
- **ユーザーからの明示的な削除指示**のみ
- 自動的な削除は行わない
- 推測による削除は行わない

## ショートカットキーの利点

### 開発効率の向上
- **Dキー**: 瞬時にデバッグライン切り替え
- **画面の邪魔にならない**: ボタンと違って画面上に表示されない
- **素早い操作**: キーボード操作で高速切り替え
- **一貫性**: 全画面で同じショートカットキー

### 使用方法
1. 開発中は常にデバッグラインを表示
2. 実際の見た目を確認したい時は「D」キーで非表示
3. レイアウト調整時は「D」キーで再表示
4. デバッグ情報が必要な時は「Shift+D」でコンソール出力

## 注意事項

### やるべきこと ✅
- DebugHelperクラスを使用する
- 全てのエリアに境界線を引く
- 色分けで区別しやすくする
- ショートカットキーを活用する

### やってはいけないこと ❌
- デバッグラインなしでレイアウト実装
- 推測による座標設定
- エリアの重なりを放置
- 本番環境にデバッグラインを残す

## 効果

### 開発効率の向上
- 座標計算ミスの早期発見
- レイアウト問題の可視化
- デバッグ時間の短縮
- 素早い表示切り替え

### 品質向上
- UI要素の重なり防止
- 正確な座標配置
- 一貫したレイアウト設計
