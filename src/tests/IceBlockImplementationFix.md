# 氷結ブロックの実装修正

## 問題点

氷結ブロックの挙動に関して、仕様と実装に不一致がありました。

### 仕様

1. 氷結ブロックは通常ブロックと同様にグループ形成に参加する
2. 氷結ブロックはレベルが下がるだけで、消去されない
   - 氷結ブロックLv2 → 氷結ブロックLv1
   - 氷結ブロックLv1 → 通常ブロック
3. 通常ブロックになった氷結ブロックは、他の通常ブロックと同様に消去される

### 実装の問題

1. 一部のテストでは、氷結ブロックが直接消去されるという誤った仕様に基づいていた
2. 実装では氷結ブロックのレベルダウンは正しく行われていたが、テストが間違っていた

## 修正内容

### 1. テストの修正

- `IceBlockRemoval.test.ts`を修正し、氷結ブロックがレベルダウンするだけで消去されないことを確認するテストに変更
- `IceBlockConsumption.test.ts`を修正し、通常ブロックのみが消去されることを確認するテストに変更

### 2. 新しいテストの追加

- `IceBlockSimpleTest.test.ts`を追加し、氷結ブロックの基本的な挙動を確認
- `GameSceneIceBlock.test.ts`を追加し、GameSceneクラスでの氷結ブロックの挙動を確認
- `IceBlockFailingTest.test.ts`を追加し、誤った実装を検出するテストを作成（修正後は成功するように変更）

### 3. 実装の確認

- `BlockLogic.ts`の`updateIceBlocks`メソッドは正しく実装されていることを確認
- `GameScene.ts`の`removeBlocks`メソッドを修正し、通常ブロックのみを消去するように変更

## テスト結果

すべてのテストが成功し、氷結ブロックの挙動が仕様通りになりました。

## 教訓

1. テスト駆動開発の原則に従い、まず失敗するテストを書いてから実装を修正すべき
2. 仕様書をよく読み、正しい挙動を理解してからテストを書くべき
3. 既存のテストが仕様と一致しているか確認することが重要
